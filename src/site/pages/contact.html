<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contact • Museum of AI</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../assets/css/tailwind.css">

  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="alternate" hreflang="sv" href="../sv/pages/contact.html">
  <link rel="alternate" hreflang="en" href="./contact.html">

  <!-- Email sending is handled server-side via /api/send-email -->
</head>
<body>
  <header class="w-full">
    <div class="container mx-auto px-4 py-6">
      <a href="../index.html" class="text-slate-300 hover:text-white">← Back to Home</a>
    </div>
  </header>

  <main class="py-16">
    <div class="container mx-auto px-4 max-w-3xl">
      <h1 class="text-4xl font-bold mb-6">Contact</h1>
      <p class="text-slate-300 mb-8">Tell us how we can help. We’ll get back to you shortly.</p>

      <div class="glass-card p-6 md:p-8 rounded-xl">
        <form id="contact-form" class="space-y-6" novalidate>
          <!-- Topic -->
          <div>
            <label for="topic" class="block text-sm font-medium text-slate-300 mb-2">Topic</label>
            <select id="topic" name="topic"
                    class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500">
              <option>General Contact</option>
              <option>Membership Application</option>
              <option>Workshop/Lecture Enquiry</option>
              <option>Press Center</option>
              <option>Careers</option>
              <option>Partnerships</option>
              <option>Donations/Sponsorship</option>
              <option>Venue Hire</option>
              <option>Accessibility</option>
              <option>Other</option>
            </select>
          </div>

          <!-- Name / Email -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="name" class="block text-sm font-medium text-slate-300 mb-2">Your name</label>
              <input id="name" name="name" type="text" required autocomplete="name"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
            <div>
              <label for="email" class="block text-sm font-medium text-slate-300 mb-2">Email</label>
              <input id="email" name="email" type="email" required autocomplete="email" inputmode="email"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
          </div>

          <!-- Optional meta -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="organization" class="block text-sm font-medium text-slate-300 mb-2">Organization (optional)</label>
              <input id="organization" name="organization" type="text" autocomplete="organization"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
            <div>
              <label for="phone" class="block text-sm font-medium text-slate-300 mb-2">Phone (optional)</label>
              <input id="phone" name="phone" type="tel" inputmode="tel" autocomplete="tel"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="website" class="block text-sm font-medium text-slate-300 mb-2">Website (optional)</label>
              <input id="website" name="website" type="url" inputmode="url" placeholder="https://"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
            <div>
              <label for="location" class="block text-sm font-medium text-slate-300 mb-2">Location (optional)</label>
              <input id="location" name="location" type="text" placeholder="City, Country"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="budget" class="block text-sm font-medium text-slate-300 mb-2">Budget (optional)</label>
              <input id="budget" name="budget" type="text" placeholder="e.g., SEK 20–50k"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
            <div>
              <label for="timeline" class="block text-sm font-medium text-slate-300 mb-2">Timeline (optional)</label>
              <input id="timeline" name="timeline" type="text" placeholder="e.g., Oct–Nov 2025"
                     class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            </div>
          </div>

          <!-- Message -->
          <div>
            <label for="message" class="block text-sm font-medium text-slate-300 mb-2">Message</label>
            <textarea id="message" name="message" rows="6" required
                      class="w-full rounded-lg bg-slate-900/50 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
          </div>

          <p class="text-xs text-slate-400">
            We use your information only to respond to your enquiry. See our
            <a href="./privacy.html" class="underline hover:text-indigo-400">Privacy Policy</a>.
          </p>

          <div class="flex items-center justify-between gap-4">
            <button type="submit"
                    class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-full font-medium transition duration-300">
              Send message
            </button>
            <span id="contact-feedback" class="text-sm text-slate-400"></span>
          </div>
        </form>
      </div>
    </div>
  </main>

  <script>
    // Client-side helper only; email is sent via /api/send-email

    // Normalize helper: strip accents, lowercase, trim
    function norm(s) {
      return (s || '')
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
        .toLowerCase().trim();
    }

    // Alias map: Swedish/English -> exact English option values
    const TOPIC_ALIASES = {
      // English -> English
      [norm('General Contact')]: 'General Contact',
      [norm('Membership Application')]: 'Membership Application',
      [norm('Workshop/Lecture Enquiry')]: 'Workshop/Lecture Enquiry',
      [norm('Press Center')]: 'Press Center',
      [norm('Careers')]: 'Careers',
      [norm('Partnerships')]: 'Partnerships',
      [norm('Donations/Sponsorship')]: 'Donations/Sponsorship',
      [norm('Venue Hire')]: 'Venue Hire',
      [norm('Accessibility')]: 'Accessibility',
      [norm('Other')]: 'Other',

      // Swedish -> English
      [norm('Allmän kontakt')]: 'General Contact',
      [norm('Medlemsansökan')]: 'Membership Application',
      [norm('Workshop/Föreläsning')]: 'Workshop/Lecture Enquiry',
      [norm('Press Center')]: 'Press Center',
      [norm('Karriär')]: 'Careers',
      [norm('Partnerskap')]: 'Partnerships',
      [norm('Donation/Sponsring')]: 'Donations/Sponsorship',
      [norm('Lokaluthyrning')]: 'Venue Hire',
      [norm('Tillgänglighet')]: 'Accessibility',
      [norm('Annat')]: 'Other'
    };

    // Prefill Topic from ?topic= (supports Swedish or English values, accent-insensitive)
    (function prefillTopic() {
      const params = new URLSearchParams(location.search);
      const raw = params.get('topic');
      if (!raw) return;
      const mapped = TOPIC_ALIASES[norm(raw)];
      const select = document.getElementById('topic');
      if (mapped) {
        select.value = mapped;
      } else {
        // Fallback to "Other"
        select.value = 'Other';
      }
    })();

    // Build a rich message while keeping the EmailJS template minimal
    function composeMessage() {
      const get = id => document.getElementById(id)?.value.trim();
      const topic = get('topic');
      const name = get('name');
      const email = get('email');
      const org = get('organization');
      const phone = get('phone');
      const website = get('website');
      const location = get('location');
      const budget = get('budget');
      const timeline = get('timeline');
      const message = get('message');

      const lines = [
        `Topic: ${topic || '—'}`,
        `Name: ${name || '—'}`,
        `Email: ${email || '—'}`,
        org ? `Organization: ${org}` : null,
        phone ? `Phone: ${phone}` : null,
        website ? `Website: ${website}` : null,
        location ? `Location: ${location}` : null,
        budget ? `Budget: ${budget}` : null,
        timeline ? `Timeline: ${timeline}` : null,
        '',
        'Message:',
        message || '—'
      ].filter(Boolean);

      return lines.join('\n');
    }

    document.getElementById('contact-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const feedback = document.getElementById('contact-feedback');

      const name = form.name.value.trim();
      const email = form.email.value.trim();
      const msg = form.message.value.trim();

      if (!name || !email || !msg) {
        alert('Please fill in your name, email, and message.');
        return;
      }

      const fullMessage = composeMessage();

      const payload = {
        kind: 'contact',
        name,
        email,
        message: fullMessage,
        reply_to: email,
        from_name: 'MAI Website',
        from_email: 'info@aimuseum.se'
      };

      const btn = form.querySelector('button[type="submit"]');
      btn.disabled = true; btn.textContent = 'Sending…'; feedback.textContent = '';

      try {
        const resp = await fetch('/api/send-email', {
          method: 'POST',
          headers: { 'content-type': 'application/json' },
          body: JSON.stringify(payload),
        });
        if (!resp.ok) {
          const data = await resp.json().catch(() => ({}));
          throw new Error(data?.error || 'Failed to send');
        }
        feedback.textContent = 'Thanks! Your message has been sent.';
        form.reset();
      } catch (err) {
        console.error('Send error:', err);
        feedback.textContent = 'Sorry, there was a problem sending your message.';
      } finally {
        btn.disabled = false; btn.textContent = 'Send message';
      }
    });
  </script>
</body>
</html>
